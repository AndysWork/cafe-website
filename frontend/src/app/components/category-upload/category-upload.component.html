<div class="upload-container">
  <div class="upload-header">
    <h1>ğŸ“¤ Category & SubCategory Upload</h1>
    <p class="subtitle">Upload Excel or CSV files to bulk import categories and subcategories</p>
  </div>

  <!-- Template Download Section -->
  <div class="template-section">
    <h3>ğŸ“¥ Download Template</h3>
    <p>Start by downloading a template file with the required format</p>
    <div class="template-buttons">
      <button class="btn btn-template" (click)="downloadTemplate('csv')">
        <span class="icon">ğŸ“„</span>
        Download CSV Template
      </button>
      <button class="btn btn-template" (click)="downloadTemplate('excel')">
        <span class="icon">ğŸ“Š</span>
        Download Excel Template
      </button>
    </div>
  </div>

  <!-- File Upload Section -->
  <div class="upload-section">
    <h3>ğŸ“ Upload File</h3>

    <!-- Drag & Drop Zone -->
    <div
      class="drop-zone"
      [class.dragging]="isDragging"
      [class.has-file]="selectedFile"
      (dragover)="onDragOver($event)"
      (dragleave)="onDragLeave($event)"
      (drop)="onDrop($event)"
      (click)="fileInput.click()">

      <input
        #fileInput
        type="file"
        accept=".xlsx,.xls,.csv"
        (change)="onFileSelected($event)"
        style="display: none">

      <div *ngIf="!selectedFile" class="drop-zone-content">
        <div class="upload-icon">â˜ï¸</div>
        <p class="drop-text">Drag & drop your file here</p>
        <p class="or-text">or</p>
        <button class="btn btn-browse">Browse Files</button>
        <p class="file-info">Supported formats: .xlsx, .xls, .csv (Max 5MB)</p>
      </div>

      <div *ngIf="selectedFile" class="selected-file">
        <div class="file-icon">{{ getFileIcon() }}</div>
        <div class="file-details">
          <p class="file-name">{{ selectedFile.name }}</p>
          <p class="file-size">{{ formatFileSize(selectedFile.size) }}</p>
        </div>
        <button class="btn-remove" (click)="clearFile(); $event.stopPropagation()">âœ•</button>
      </div>
    </div>

    <!-- Progress Bar -->
    <div *ngIf="isUploading" class="progress-container">
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="uploadProgress"></div>
      </div>
      <p class="progress-text">Uploading... {{ uploadProgress }}%</p>
    </div>

    <!-- Upload Button -->
    <div class="action-buttons" *ngIf="selectedFile && !isUploading">
      <button class="btn btn-upload" (click)="uploadFile()">
        <span class="icon">ğŸš€</span>
        Upload File
      </button>
      <button class="btn btn-cancel" (click)="clearFile()">
        Cancel
      </button>
    </div>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-error">
    <span class="alert-icon">âš ï¸</span>
    <span>{{ errorMessage }}</span>
  </div>

  <!-- Upload Result -->
  <div *ngIf="uploadResult" class="upload-result">
    <div class="result-card" [class.success]="uploadResult.Success" [class.error]="!uploadResult.Success">
      <div class="result-header">
        <span class="result-icon">{{ uploadResult.Success ? 'âœ…' : 'âŒ' }}</span>
        <h3>{{ uploadResult.Success ? 'Upload Successful!' : 'Upload Failed' }}</h3>
      </div>

      <p class="result-message">{{ uploadResult.Message }}</p>

      <div class="result-stats" *ngIf="uploadResult.Success">
        <div class="stat">
          <span class="stat-value">{{ uploadResult.CategoriesProcessed }}</span>
          <span class="stat-label">Categories Imported</span>
        </div>
        <div class="stat">
          <span class="stat-value">{{ uploadResult.SubCategoriesProcessed }}</span>
          <span class="stat-label">SubCategories Imported</span>
        </div>
      </div>

      <div *ngIf="uploadResult.Errors && uploadResult.Errors.length > 0" class="error-list">
        <h4>Errors:</h4>
        <ul>
          <li *ngFor="let error of uploadResult.Errors">{{ error }}</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Instructions -->
  <div class="instructions">
    <h3>ğŸ“‹ File Format Instructions</h3>
    <div class="instruction-content">
      <p><strong>Required Columns (Simplified Format):</strong></p>
      <ol>
        <li><strong>CategoryName</strong> - Name of the category (required)</li>
        <li><strong>SubCategoryName</strong> - Name of the subcategory (optional)</li>
      </ol>
      <p><strong>Example Data:</strong></p>
      <table style="width: 100%; border-collapse: collapse; margin: 1rem 0;">
        <thead>
          <tr style="background: #f7fafc;">
            <th style="padding: 0.5rem; border: 1px solid #e2e8f0; text-align: left;">CategoryName</th>
            <th style="padding: 0.5rem; border: 1px solid #e2e8f0; text-align: left;">SubCategoryName</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding: 0.5rem; border: 1px solid #e2e8f0;">Beverages</td>
            <td style="padding: 0.5rem; border: 1px solid #e2e8f0;">Coffee</td>
          </tr>
          <tr style="background: #f7fafc;">
            <td style="padding: 0.5rem; border: 1px solid #e2e8f0;">Beverages</td>
            <td style="padding: 0.5rem; border: 1px solid #e2e8f0;">Tea</td>
          </tr>
          <tr>
            <td style="padding: 0.5rem; border: 1px solid #e2e8f0;">Food</td>
            <td style="padding: 0.5rem; border: 1px solid #e2e8f0;">Sandwiches</td>
          </tr>
          <tr style="background: #f7fafc;">
            <td style="padding: 0.5rem; border: 1px solid #e2e8f0;">Snacks</td>
            <td style="padding: 0.5rem; border: 1px solid #e2e8f0;"></td>
          </tr>
        </tbody>
      </table>
      <div class="tip">
        <p><strong>ğŸ’¡ Tips:</strong></p>
        <ul>
          <li>Multiple rows with the same CategoryName will create multiple subcategories under one category</li>
          <li>Leave SubCategoryName empty to create a category without subcategories</li>
          <li>If CategoryName equals SubCategoryName, only the category will be created</li>
          <li>Duplicate entries are automatically skipped</li>
        </ul>
      </div>
    </div>
  </div>
</div>
