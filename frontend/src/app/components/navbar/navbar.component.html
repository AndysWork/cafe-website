<!-- Mobile Menu Toggle -->
<button class="mobile-menu-toggle"
        [class.active]="isMobileMenuOpen"
        (click)="toggleMobileMenu()">
  <span class="hamburger-line"></span>
  <span class="hamburger-line"></span>
  <span class="hamburger-line"></span>
</button>

<!-- Mobile Overlay -->
<div class="mobile-overlay"
     [class.active]="isMobileMenuOpen"
     (click)="closeMobileMenu()"></div>

<nav class="navbar" [class.mobile-open]="isMobileMenuOpen">
  <div class="navbar-container">
    <!-- Logo -->
    <a routerLink="/" class="navbar-brand" (click)="closeMobileMenu()">
      <img src="/Logo.jpg" alt="Maa Tara Cafe Logo" class="brand-logo">
    </a>

    <!-- Desktop Menu -->
    <div class="navbar-menu" [class.active]="isMobileMenuOpen">
      <ul class="navbar-nav">
        <!-- Menu (Users Only) -->
        <li class="nav-item" *ngIf="isUser">
          <a routerLink="/menu" routerLinkActive="active" class="nav-link" (click)="closeMobileMenu()">
            <span class="nav-icon">ğŸ½ï¸</span>
            Menu
          </a>
        </li>

        <!-- Admin Only: Category Update with Dropdown -->
        <li class="nav-item dropdown" *ngIf="isAdmin"
            [class.active]="activeDropdown === 'category'"
            (mouseenter)="openDropdown('category')"
            (mouseleave)="scheduleCloseDropdown()">
          <button class="nav-link dropdown-toggle"
                  (click)="toggleDropdown('category')">
            <span class="nav-icon">ğŸ“</span>
            Category Update
            <span class="arrow" [class.open]="activeDropdown === 'category'">â–¼</span>
          </button>

          <ul class="dropdown-menu"
              [class.show]="activeDropdown === 'category'"
              (mouseenter)="cancelCloseDropdown()"
              (mouseleave)="scheduleCloseDropdown()">
            <li>
              <a routerLink="/category/upload"
                 routerLinkActive="active"
                 class="dropdown-item"
                 (click)="closeMobileMenu()">
                <span class="dropdown-icon">ğŸ“¤</span>
                <div class="dropdown-content">
                  <span class="dropdown-title">Upload</span>
                  <span class="dropdown-desc">Bulk upload via CSV/Excel</span>
                </div>
              </a>
            </li>
            <li>
              <a routerLink="/category/crud"
                 routerLinkActive="active"
                 class="dropdown-item"
                 (click)="closeMobileMenu()">
                <span class="dropdown-icon">âœï¸</span>
                <div class="dropdown-content">
                  <span class="dropdown-title">CRUD</span>
                  <span class="dropdown-desc">Manage categories manually</span>
                </div>
              </a>
            </li>
          </ul>
        </li>

        <!-- Admin Only: Tools Dropdown -->
        <li class="nav-item dropdown" *ngIf="isAdmin"
            [class.active]="activeDropdown === 'tools'"
            (mouseenter)="openDropdown('tools')"
            (mouseleave)="scheduleCloseDropdown()">
          <button class="nav-link dropdown-toggle"
                  (click)="toggleDropdown('tools')">
            <span class="nav-icon">ğŸ› ï¸</span>
            Tools
            <span class="arrow" [class.open]="activeDropdown === 'tools'">â–¼</span>
          </button>

          <ul class="dropdown-menu"
              [class.show]="activeDropdown === 'tools'"
              (mouseenter)="cancelCloseDropdown()"
              (mouseleave)="scheduleCloseDropdown()">
            <li>
              <a routerLink="/admin/cashier"
                 routerLinkActive="active"
                 class="dropdown-item"
                 (click)="closeMobileMenu()">
                <span class="dropdown-icon">ğŸ§¾</span>
                <div class="dropdown-content">
                  <span class="dropdown-title">Cashier</span>
                  <span class="dropdown-desc">Process in-person sales</span>
                </div>
              </a>
            </li>
            <li>
              <a routerLink="/admin/online-sale-tracker"
                 routerLinkActive="active"
                 class="dropdown-item"
                 (click)="closeMobileMenu()">
                <span class="dropdown-icon">ğŸ“Š</span>
                <div class="dropdown-content">
                  <span class="dropdown-title">Online Sale Tracker</span>
                  <span class="dropdown-desc">Monitor online sales</span>
                </div>
              </a>
            </li>
            <li>
              <a routerLink="/admin/online-profit-tracker"
                 routerLinkActive="active"
                 class="dropdown-item"
                 (click)="closeMobileMenu()">
                <span class="dropdown-icon">ğŸ’¹</span>
                <div class="dropdown-content">
                  <span class="dropdown-title">Online Profit Tracker</span>
                  <span class="dropdown-desc">Track profitability</span>
                </div>
              </a>
            </li>
            <li>
              <a routerLink="/admin/discount-mapping"
                 routerLinkActive="active"
                 class="dropdown-item"
                 (click)="closeMobileMenu()">
                <span class="dropdown-icon">ğŸ’³</span>
                <div class="dropdown-content">
                  <span class="dropdown-title">Discount Mapping</span>
                  <span class="dropdown-desc">View coupon analytics</span>
                </div>
              </a>
            </li>
          </ul>
        </li>

        <!-- Regular User: Orders -->
        <li class="nav-item" *ngIf="isUser">
          <a routerLink="/orders" routerLinkActive="active" class="nav-link" (click)="closeMobileMenu()">
            <span class="nav-icon">ğŸ›’</span>
            Orders
          </a>
        </li>

        <!-- Regular User: Offers -->
        <li class="nav-item" *ngIf="isUser">
          <a routerLink="/offers" routerLinkActive="active" class="nav-link" (click)="closeMobileMenu()">
            <span class="nav-icon">ğŸ</span>
            Offers
          </a>
        </li>

        <!-- Regular User: Loyalty Points -->
        <li class="nav-item" *ngIf="isUser">
          <a routerLink="/loyalty" routerLinkActive="active" class="nav-link" (click)="closeMobileMenu()">
            <span class="nav-icon">â­</span>
            Loyalty Points
          </a>
        </li>

        <!-- Profile (Users Only) -->
        <li class="nav-item" *ngIf="isUser">
          <a routerLink="/profile" routerLinkActive="active" class="nav-link" (click)="closeMobileMenu()">
            <span class="nav-icon">ğŸ‘¤</span>
            Profile
          </a>
        </li>

        <!-- Cart (Users Only) -->
        <li class="nav-item cart-item" *ngIf="isUser">
          <a routerLink="/cart" routerLinkActive="active" class="nav-link" (click)="closeMobileMenu()">
            <span class="nav-icon cart-icon">
              ğŸ›’
              <span class="cart-badge" *ngIf="cartItemCount > 0">{{ cartItemCount }}</span>
            </span>
            Cart
          </a>
        </li>
      </ul>

      <!-- Login/Logout Button -->
      <div class="auth-section">
        <button *ngIf="!isLoggedIn" class="btn-login" (click)="onLogin()">
          <span class="login-icon">ğŸ”</span>
          Login
        </button>
        <div *ngIf="isLoggedIn" class="user-section">
          <span class="username">{{ displayName }}</span>
          <button class="btn-logout" (click)="onLogout()">
            <span class="logout-icon">ğŸšª</span>
            Logout
          </button>
        </div>
      </div>
    </div>
  </div>
</nav>
