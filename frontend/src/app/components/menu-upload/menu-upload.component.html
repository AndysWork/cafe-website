<div class="menu-upload-container">
  <div class="upload-header">
    <h1>ğŸ“¤ Upload Menu Items</h1>
    <p>Upload an Excel file containing your menu items with categories, variants, and pricing</p>
  </div>

  <!-- Instructions Card -->
  <div class="instructions-card">
    <h3>ğŸ“‹ Excel File Format</h3>
    <p>Your Excel file should have the following columns:</p>
    <div class="column-list">
      <div class="column-item">
        <span class="column-name">category_name</span>
        <span class="column-desc">Category name (must exist in database)</span>
      </div>
      <div class="column-item">
        <span class="column-name">subcategory_name</span>
        <span class="column-desc">Subcategory name (must exist in database)</span>
      </div>
      <div class="column-item">
        <span class="column-name">catalogue_name</span>
        <span class="column-desc">Menu item name</span>
      </div>
      <div class="column-item">
        <span class="column-name">variant_name</span>
        <span class="column-desc">Variant (e.g., "250ml", "500ml", "Large")</span>
      </div>
      <div class="column-item">
        <span class="column-name">current_price</span>
        <span class="column-desc">Price for this variant</span>
      </div>
      <div class="column-item">
        <span class="column-name">description</span>
        <span class="column-desc">Item description</span>
      </div>
    </div>
    <button class="btn-template" (click)="downloadTemplate()">
      <span class="icon">ğŸ“¥</span>
      Download CSV Template
    </button>
  </div>

  <!-- Upload Area -->
  <div class="upload-area"
       [class.drag-over]="dragOver"
       (dragover)="onDragOver($event)"
       (dragleave)="onDragLeave($event)"
       (drop)="onDrop($event)">

    <div class="upload-icon">ğŸ“</div>

    <div *ngIf="!selectedFile" class="upload-prompt">
      <h3>Drag & Drop Excel File Here</h3>
      <p>or</p>
      <label for="fileInput" class="btn-select-file">
        <span class="icon">ğŸ“‚</span>
        Browse Files
      </label>
      <input
        type="file"
        id="fileInput"
        accept=".xlsx,.xls"
        (change)="onFileSelected($event)"
        style="display: none;">
      <p class="file-info">Supported formats: .xlsx, .xls</p>
    </div>

    <div *ngIf="selectedFile" class="file-selected">
      <div class="file-icon">ğŸ“„</div>
      <div class="file-details">
        <h4>{{ selectedFile.name }}</h4>
        <p>{{ (selectedFile.size / 1024).toFixed(2) }} KB</p>
      </div>
      <button class="btn-remove" (click)="clearSelection()" [disabled]="uploading">
        âœ•
      </button>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="action-buttons" *ngIf="selectedFile">
    <div class="checkbox-container">
      <label class="checkbox-label">
        <input
          type="checkbox"
          [(ngModel)]="clearExisting"
          [disabled]="uploading">
        <span>Clear existing menu items before upload</span>
      </label>
      <p class="checkbox-hint">âš ï¸ This will delete all current menu items from the database</p>
    </div>
    <button
      class="btn-upload"
      (click)="uploadFile()"
      [disabled]="uploading">
      <span class="icon" *ngIf="!uploading">ğŸš€</span>
      <span class="spinner" *ngIf="uploading">â³</span>
      {{ uploading ? 'Uploading...' : 'Upload Menu Items' }}
    </button>
  </div>

  <!-- Error Message -->
  <div class="error-message" *ngIf="error">
    <span class="error-icon">âš ï¸</span>
    <p>{{ error }}</p>
  </div>

  <!-- Upload Result -->
  <div class="result-card" *ngIf="uploadResult">
    <div class="result-header">
      <span class="success-icon">âœ…</span>
      <h3>Upload Successful!</h3>
    </div>

    <div class="result-stats">
      <div class="stat-item">
        <span class="stat-value">{{ uploadResult.totalRows }}</span>
        <span class="stat-label">Total Rows</span>
      </div>
      <div class="stat-item">
        <span class="stat-value">{{ uploadResult.processedItems }}</span>
        <span class="stat-label">Menu Items</span>
      </div>
      <div class="stat-item">
        <span class="stat-value">{{ uploadResult.savedItems }}</span>
        <span class="stat-label">Saved</span>
      </div>
    </div>

    <p class="result-message">{{ uploadResult.message }}</p>

    <div class="errors-section" *ngIf="uploadResult.errors && uploadResult.errors.length > 0">
      <h4>âš ï¸ Errors ({{ uploadResult.errors.length }})</h4>
      <div class="error-list">
        <div class="error-item" *ngFor="let err of uploadResult.errors">
          {{ err }}
        </div>
      </div>
    </div>
  </div>
</div>
